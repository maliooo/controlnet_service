[2025-06-23 09:18:06,913] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/malio/lib/python3.10/site-packages/deepspeed/runtime/zero/linear.py:49: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  def forward(ctx, input, weight, bias=None):
/root/miniconda3/envs/malio/lib/python3.10/site-packages/deepspeed/runtime/zero/linear.py:67: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.4
[93m [WARNING] [0m using untested triton version (3.0.0), only 1.0.0 is known to be compatible
ä½¿ç”¨è®¾å¤‡: cuda
/root/miniconda3/envs/malio/lib/python3.10/site-packages/transformers/utils/deprecation.py:172: UserWarning: The following named arguments are not valid for `OneFormerImageProcessor.__init__` and were ignored: '_max_size'
  return func(*args, **kwargs)
df.columns: Index(['Idx', 'Ratio', 'Train', 'Val', 'Stuff', 'Color_Code 
(R,G,B)',
       'Color_Code(hex)', 'Color', 'Name'],
      dtype='object')
å¯åŠ¨æœåŠ¡äº http://0.0.0.0:8003
INFO:     Started server process [87971]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8003 (Press CTRL+C to quit)
è°ƒç”¨å‡½æ•° segment_image_base64, è¯·æ±‚å‚æ•°ä¸º: 512, 1.0, False
/home/zhangxuqi/malio/code/controlnet_service/oneformer_segmentation_service_cache.py:427: PydanticDeprecatedSince20: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
  params = request_data.dict()
/root/miniconda3/envs/malio/lib/python3.10/site-packages/torch/functional.py:513: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3609.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
æ¨¡å‹segæ¨ç†æ—¶é—´ä¸º: 0.68s
å°†åˆ†å‰²ç»“æœè½¬æ¢ä¸ºnumpyæ•°ç»„æ—¶é—´ä¸º: 0.00s
åˆ›å»ºADE20Kçš„metadataæ—¶é—´ä¸º: 0.00s
åˆ›å»ºå¯è§†åŒ–å™¨æ—¶é—´ä¸º: 0.02s
ç»˜åˆ¶è¯­ä¹‰åˆ†å‰²ç»“æœæ—¶é—´ä¸º: 0.18s
å¯è§†åŒ–æ—¶é—´ä¸º: 0.32s
è½¬æ¢ä¸ºbase64æ—¶é—´ä¸º: 0.06s
ç»“æœå·²å­˜å…¥ç¼“å­˜
æœåŠ¡å¤„ç†æ—¶é—´ä¸º: 1.19s
INFO:     172.18.0.1:40360 - "POST /segment_image_base64 HTTP/1.1" 200 OK
è°ƒç”¨å‡½æ•° segment_image_base64, è¯·æ±‚å‚æ•°ä¸º: 512, 1.0, False
æ¨¡å‹segæ¨ç†æ—¶é—´ä¸º: 0.11s
å°†åˆ†å‰²ç»“æœè½¬æ¢ä¸ºnumpyæ•°ç»„æ—¶é—´ä¸º: 0.00s
åˆ›å»ºADE20Kçš„metadataæ—¶é—´ä¸º: 0.00s
åˆ›å»ºå¯è§†åŒ–å™¨æ—¶é—´ä¸º: 0.02s
ç»˜åˆ¶è¯­ä¹‰åˆ†å‰²ç»“æœæ—¶é—´ä¸º: 0.20s
å¯è§†åŒ–æ—¶é—´ä¸º: 0.43s
è½¬æ¢ä¸ºbase64æ—¶é—´ä¸º: 0.09s
ç»“æœå·²å­˜å…¥ç¼“å­˜
æœåŠ¡å¤„ç†æ—¶é—´ä¸º: 0.75s
INFO:     172.18.0.1:40616 - "POST /segment_image_base64 HTTP/1.1" 200 OK
è°ƒç”¨å‡½æ•° segment_image_base64, è¯·æ±‚å‚æ•°ä¸º: 512, 1.0, True
æ¨¡å‹segæ¨ç†æ—¶é—´ä¸º: 0.09s
å°†åˆ†å‰²ç»“æœè½¬æ¢ä¸ºnumpyæ•°ç»„æ—¶é—´ä¸º: 0.00s
åˆ›å»ºADE20Kçš„metadataæ—¶é—´ä¸º: 0.00s
åˆ›å»ºå¯è§†åŒ–å™¨æ—¶é—´ä¸º: 0.02s
ç»˜åˆ¶è¯­ä¹‰åˆ†å‰²ç»“æœæ—¶é—´ä¸º: 0.27s
å¯è§†åŒ–æ—¶é—´ä¸º: 0.53s
è½¬æ¢ä¸ºbase64æ—¶é—´ä¸º: 0.07s
æœåŠ¡å¤„ç†æ—¶é—´ä¸º: 0.83s
INFO:     172.18.0.1:40686 - "POST /segment_image_base64 HTTP/1.1" 200 OK
è°ƒç”¨å‡½æ•° segment_image_base64, è¯·æ±‚å‚æ•°ä¸º: 512, 1.0, False
ä»ç¼“å­˜ä¸­è·å–ç»“æœ
INFO:     172.18.0.1:40702 - "POST /segment_image_base64 HTTP/1.1" 200 OK
è°ƒç”¨å‡½æ•° segment_image_base64, è¯·æ±‚å‚æ•°ä¸º: 512, 1.0, False
ä»ç¼“å­˜ä¸­è·å–ç»“æœ
INFO:     172.18.0.1:44862 - "POST /segment_image_base64 HTTP/1.1" 200 OK
è°ƒç”¨å‡½æ•° segment_image_base64, è¯·æ±‚å‚æ•°ä¸º: 512, 1.0, False
ä»ç¼“å­˜ä¸­è·å–ç»“æœ
INFO:     172.18.0.1:47278 - "POST /segment_image_base64 HTTP/1.1" 200 OK
è°ƒç”¨å‡½æ•° segment_image_base64, è¯·æ±‚å‚æ•°ä¸º: 512, 1.0, False
ä»ç¼“å­˜ä¸­è·å–ç»“æœ
INFO:     172.18.0.1:47524 - "POST /segment_image_base64 HTTP/1.1" 200 OK
è°ƒç”¨å‡½æ•° segment_image_base64, è¯·æ±‚å‚æ•°ä¸º: 512, 1.0, False
æ¨¡å‹segæ¨ç†æ—¶é—´ä¸º: 0.09s
å°†åˆ†å‰²ç»“æœè½¬æ¢ä¸ºnumpyæ•°ç»„æ—¶é—´ä¸º: 0.00s
åˆ›å»ºADE20Kçš„metadataæ—¶é—´ä¸º: 0.00s
åˆ›å»ºå¯è§†åŒ–å™¨æ—¶é—´ä¸º: 0.02s
ç»˜åˆ¶è¯­ä¹‰åˆ†å‰²ç»“æœæ—¶é—´ä¸º: 0.23s
å¯è§†åŒ–æ—¶é—´ä¸º: 0.40s
è½¬æ¢ä¸ºbase64æ—¶é—´ä¸º: 0.03s
ç»“æœå·²å­˜å…¥ç¼“å­˜
æœåŠ¡å¤„ç†æ—¶é—´ä¸º: 0.61s
INFO:     172.18.0.1:47540 - "POST /segment_image_base64 HTTP/1.1" 200 OK
è°ƒç”¨å‡½æ•° segment_image_base64, è¯·æ±‚å‚æ•°ä¸º: 512, 1.0, False
æ¨¡å‹segæ¨ç†æ—¶é—´ä¸º: 0.08s
å°†åˆ†å‰²ç»“æœè½¬æ¢ä¸ºnumpyæ•°ç»„æ—¶é—´ä¸º: 0.00s
åˆ›å»ºADE20Kçš„metadataæ—¶é—´ä¸º: 0.00s
åˆ›å»ºå¯è§†åŒ–å™¨æ—¶é—´ä¸º: 0.01s
ç»˜åˆ¶è¯­ä¹‰åˆ†å‰²ç»“æœæ—¶é—´ä¸º: 0.11s
å¯è§†åŒ–æ—¶é—´ä¸º: 0.20s
è½¬æ¢ä¸ºbase64æ—¶é—´ä¸º: 0.01s
ç»“æœå·²å­˜å…¥ç¼“å­˜
æœåŠ¡å¤„ç†æ—¶é—´ä¸º: 0.37s
INFO:     172.18.0.1:48356 - "POST /segment_image_base64 HTTP/1.1" 200 OK
è°ƒç”¨å‡½æ•° segment_image_base64, è¯·æ±‚å‚æ•°ä¸º: 512, 1.0, False
ä»ç¼“å­˜ä¸­è·å–ç»“æœ
INFO:     172.18.0.1:48390 - "POST /segment_image_base64 HTTP/1.1" 200 OK
è°ƒç”¨å‡½æ•° segment_image_base64, è¯·æ±‚å‚æ•°ä¸º: 512, 1.0, False
ä»ç¼“å­˜ä¸­è·å–ç»“æœ
INFO:     172.18.0.1:48418 - "POST /segment_image_base64 HTTP/1.1" 200 OK
è°ƒç”¨å‡½æ•° segment_image_base64, è¯·æ±‚å‚æ•°ä¸º: 512, 1.0, False
ä»ç¼“å­˜ä¸­è·å–ç»“æœ
INFO:     172.18.0.1:51850 - "POST /segment_image_base64 HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [87971]
